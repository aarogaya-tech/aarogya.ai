{% extends 'main/base.html' %}
{% block title %}Clients Detail Page{% endblock %}
{% block content %}
<h3 class="mt-5 p-3" style="background: #D4B2A7BF; border-radius: 1rem;">{{ client.full_name }}</h3><br />
<div class="container-fluid">
    <div class="container-fluid mt-3">
        <ul>
            <li>Email: {{ client.email }}</li>
            <li>Contact: {{ client.contact }}</li>
            <li>Address: {{ client.address }}</li>
            <li>Education: {{ client.education }}</li>
        </ul>
    </div>

    <div class="container-fluid m-0 mt-3 p-0">
        <div class="row">
            <div class="col-2 mt-5" style="border-right: 3px solid #A38F86;padding-right: 1.5rem">
                <h5 class="mb-3 text-lato p-3" style="background: #D4B2A7BF; border-radius: 1rem;">TIMELINE</h5>
                {% for session in sessions %}
                    <a href={% url 'client-detail-with-transcript' client_id=client.id session_id=session.id %}>
                        <div class="client-card">
                            Session # {{ forloop.counter }}
                        </div>
                    </a>
                {% endfor %}
                <a href="{% url 'new-session' client.id %}" class="btn btn-primary mt-3">Add new client session</a>
            </div>
            <div class="col-7 mt-5" style="border-right: 3px solid #A38F86;padding-right: 1.5rem">
                <h5 class="mb-3 text-lato p-3" style="background: #D4B2A7BF; border-radius: 1rem;">TRANSCRIPT</h5>
                <div class="card-text">
                    Session Date: {{ session.session_date }}<br>
                    Session Time: {{ session.session_time }}
                    {% if transcript %}
                        <h5>Transcript</h5>
                        <p>{{ transcript.content }}</p>
                        <blockquote class="blockquote">
                            <strong>Autogenerated Transcript</strong>
                            {% if transcript.transcript_generation_in_progress %}
                                <p>Autogeneration in progress... </p>
                            {% else %}
                                {{ transcript.generated_transcript }}
                            {% endif %}
                        </blockquote>
                    {% else %}
                    <p>Transcripts not available.</p>
                    {% endif %}
                </div>
            </div>
            <div class="col-3 mt-5" style="padding-right: 1.5rem">
                <h5 class="mb-3 text-lato p-3" style="background: #D4B2A7BF; border-radius: 1rem;">SESSION DETAILS</h5>
                {% load crispy_forms_tags %}
                <form method="post">
                    {% csrf_token %}{{session_notes|crispy}}
                    <button type="submit" class="btn btn-success">Save</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}